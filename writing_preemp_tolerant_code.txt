1> entire code in try-catch, and clean the environment and shutdown
2> save weights frequently

